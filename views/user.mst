<!doctype html>
<html lang="ru">
    {{> head}}
    <body>
        <header class="navbar">
            {{> header}}
        </header>
        <main class="container mt-4" role="main">
            <nav aria-label="breadcrumb">
               {{> breadcrumb}}
            </nav>
            {{#user}}
            <div class="user-info text-center">
                <img src="{{avaUrl}}" alt="user photo">
                <h1 class="mb-4">{{fullname}}{{#role}}<i class="far fa-star ml-1"></i>{{/role}}</h1>
                <p><a href="" class="link-style">{{login}}</a> <span>{{registeredAt}}</span></p>
                <p>Телефон: <b>{{phone}}</b>, email: <b>{{email}}</b></p>
                <div>
                    {{{bio}}}
                    {{^bio}}
                    <i>Біографія поки що не заповнена</i>
                    {{/bio}}
                </div>
                
            </div>
            <div class="content-bottom my-3">
                <p>{{fullname}} створив(-ла) <b>{{totalInvoices}}</b> накладних у <b>{{registries.length}}</b> реєстрах.</p>
                <p>
                    {{#registries.0}}
                    Список з <b>{{registries.length}}</b> реєстрів користувача. <i>(у дужках зазначено к-сть ТТН)</i>
                    {{/registries.0}}
                    {{^registries.0}}
                    Цей користувач ще не створив реєстрів.
                    {{/registries.0}}
                </p>
                <ul class="list-inline">
                    {{#registries}}
                        <li><a target="_blank"  class="link-style" href="/registries/{{number}}">{{number}} - {{name}}</a> ({{invoices.length}})</li>
                    {{/registries}}
                </ul>
                <p> 
                    {{#upcomingInvoices.0}}
                    Усього <b>{{upcomingInvoices.length}}</b> накладних, які були відправлені цьому користувачу:
                    {{/upcomingInvoices.0}}
                    {{^upcomingInvoices.0}}
                    Цьому користувачу ще нічого не відправили.
                    {{/upcomingInvoices.0}}
                </p>
                <ul class="list-inline">
                    {{#upcomingInvoices}}
                        <li><a target="_blank"  class="link-style" href="/invoices/{{number}}">{{number}}</a></li>
                    {{/upcomingInvoices}}
                </ul>
            </div>
            <p class="text-center">Дії з акаунтом:</p>
            <div class="actions default-form mb-4">
                {{#changeInfo}}
                <form class="mx-auto form-inline py-2 update-btn" action="/users/edit" method="POST">
                    <input name="id" type="hidden" value="{{id}}">
                    <button class="btn btn-primary btn-sm mx-auto" type="submit">Редагувати акаунт</button>
                </form>
                {{/changeInfo}}
                {{#chageRole}}
                <form class="mx-auto change-role" action="/users/changeRole" method="POST">
                    <input name="id" type="hidden" value="{{id}}">
                    <div class="form-row py-2">
                        <div class="form-inline mb-1 mx-auto">
                            <select name="role" class="custom-select custom-select-sm mr-sm-3 mr-0 text-center" required>
                                <option {{^role}}selected{{/role}} value="0">Звичайний користувач</option>
                                <option {{#role}}selected{{/role}} value="1">Адмін</option>
                            </select>
                            <button class="btn btn-primary btn-sm mx-auto mt-sm-0 mt-2" data-toggle="modal" data-target="#changeRoleModal" type="button">Зберегти</button>
                        </div>
                    </div>
                    <!-- Modal -->
                    <div class="modal fade" id="changeRoleModal" tabindex="-1" role="dialog" aria-labelledby="changeRoleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="changeRoleModalLabel">Збереження змін</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    Ви впевнені, що хочете змінити роль?
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрити</button>
                                    <button class="btn btn-primary" type="submit">Змінити</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Modal END --> 
                </form>
                {{/chageRole}}
            </div>
            {{/user}}
        </main>
        <footer class="footer">
            {{> footer}}
        </footer>
        {{> scripts}}
    </body>
</html>